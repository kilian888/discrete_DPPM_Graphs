| 07-01 16:39:22 load dataset: planar_60_200_pkl
200
/usr/itetnas04/data-scratch-01/khaefeli/data/discrete_ddpm_graphs/ppgn_vlb.py:195: DeprecationWarning: This function is deprecated. Please call randint(1, 64 + 1) instead
  sigma_ind_list = np.random.random_integers(low=1,high=config.num_levels[0],size=train_adj_b.size(0))
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
u
u
u
u
u
ubu
u
u
u
Traceback (most recent call last):
  File "/usr/itetnas04/data-scratch-01/khaefeli/data/discrete_ddpm_graphs/ppgn_vlb.py", line 522, in <module>
    train_main(config_dict, args)
  File "/usr/itetnas04/data-scratch-01/khaefeli/data/discrete_ddpm_graphs/ppgn_vlb.py", line 503, in train_main
    fit(model, optimizer, None, train_dl,
  File "/usr/itetnas04/data-scratch-01/khaefeli/data/discrete_ddpm_graphs/ppgn_vlb.py", line 227, in fit
    score_batch=model(A=train_noise_adj_b_chunked[i].unsqueeze(0).to(config.dev),node_features=train_noise_adj_b_chunked[i].to(config.dev),mask=mask.to(config.dev),noiselevel=sigma).to(config.dev)
  File "/itet-stor/khaefeli/net_scratch/conda_envs/SPECTRE/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/itetnas04/data-scratch-01/khaefeli/data/discrete_ddpm_graphs/model/ppgn.py", line 172, in forward
    out = self.forward_cat(A, node_features, mask, noiselevel)
  File "/usr/itetnas04/data-scratch-01/khaefeli/data/discrete_ddpm_graphs/model/ppgn.py", line 232, in forward_cat
    u = masked_instance_norm2D(u, mask)
  File "/usr/itetnas04/data-scratch-01/khaefeli/data/discrete_ddpm_graphs/util/model_helper.py", line 182, in masked_instance_norm2D
    mean = (torch.sum(x * mask, dim=[1,2]) / torch.sum(mask, dim=[1,2]))   # (N,C)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 11.91 GiB total capacity; 11.13 GiB already allocated; 21.00 MiB free; 11.13 GiB reserved in total by PyTorch)